[toc]

## 正则表达式

正则表达式可以用来匹配字符串。

通过正则表达式，可以实现字符串的截取或按规则替换和验证字符串内容。

正则表达式独立于语言，很多语言都支持正则表达式。（并非 JavaScript 特性）。

## 在 JS 中创建正则表达式对象

_`//`中间不写内容就是注释，`/.../`就是正则表达式。_

```js
//第一种方法
var reg = new RegExp("123");
//第二种方法 简写
var reg = /123/;
```

类似于数组

```js
var list = new Array();

var list = [];
```

## 正则表达式

### 正则表达式的语法

- `^`：开头

- `$`：结尾

  `^`规定开头，`$` 规定结尾 ，如这个就是第一位只能是字母，因为字符串的第一位是 1，所以匹配失败。

  ```js
  var str = "1";
  var reg = /^[a-z]$/;
  var result = reg.test(str);
  console.log(result); //false
  ```

- `[]`：范围

  [a-z]：小写字母、[0-9]：数字、[A-Z]：大写字母。

  `[]`范围 要加范围直接在括号里加

  ```js
  var str = "s";
  var reg = /[a-z]/;
  var result = reg.test(str);
  console.log(result); //true
  ```

- `{}` ：位数

  `/^[a-z]{3}$/` 表示要三位都是字母，多了不行，少了也不行。

  ```js
  var str = "abc";
  var reg = /^[a-z]{3}$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

  ```js
  var str = "abcd";
  var reg = /^[a-z]{3}$/;
  var result = reg.test(str);
  console.log(result); // false
  ```

- `()` ：分组

  如，截取字符串

  ```js
  var str = "2021-2-1";
  // `()` 分组
  var reg = /^(\d{4})-(\d{1,2})-(\d{1,2})$/;
  var result = reg.exec(str);
  console.log(result); // ["2019-12-01", "2019", "12", "01", index: 0, input: "2019-12-01", groups: undefined]
  console.log(result[1]); // 2019
  console.log(result[2]); // 12
  console.log(result[3]); // 01
  ```

- `+` ：匹配 1 位或多位，同`{1,}`

  `{x,y}` {5,8}：只能 5~8 位之间。`{1，}` = `+`：1 到多位。

  ```js
  var str = "testabcd"; //7位
  var reg = /^[a-z]{5,8}$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

- `?` ：0 位或 1 位，同`{0,1}`

  `?`代表 0 位或 1 位 ， `?` = `{0,1}`

  ```js
  var str = "1";
  var reg = /^\d?$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

  ```js
  var str = "11";
  var reg = /^\d?$/;
  var result = reg.test(str);
  console.log(result); // false
  ```

  ```js
  //0位
  var str = ""; //空字符串
  var reg = /^\d?$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

- `.` ：匹配所有

  `.` 匹配所有 随便写什么都行别留空就行。

  ```js
  var str = ""; //空字符串
  var reg = /^.+$/;
  var result = reg.test(str);
  console.log(result); //false
  ```

  ```js
  var str = "312FASFAasdsad2312——";
  var reg = /^.+$/;
  var result = reg.test(str);
  console.log(result); //true
  ```

- `\` ：转义

  `\`转义符 要想匹配得到就要转义

  ```js
  var str = "1+";
  // `\`转义符
  var reg = /^1\+$/;
  var result = reg.test(str);
  console.log(result); //true
  ```

  ```js
  var str = "1+";
  var reg = /^1+$/;
  var result = reg.test(str);
  console.log(result); //false
  ```

- `\d` ：数字

  `[0-9]` = `\d`

- `\w` ：数字、字母、下划线

  `[a-z 0-9 A-Z _]` = `\w`

  `[a-z 0-9 A-Z _]`：只能输入 0\~9 的数字、a\~z 小写字母、A\~Z 大写字母或者下划线

  ```js
  var str = "teSta1_d";
  var reg = /^[a-z 0-9 A-Z _]{5,8}$/;
  //var reg = /^\w{5,8}$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

- `\s` ：空格或换行

  ```js
  var str = " "; //空格
  var reg = /^\s$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

  ```js
  var str = "  "; //空格
  var reg = /^\s+$/;
  var result = reg.test(str);
  console.log(result); // true
  ```

- `g`

  全局匹配，找到所有能匹配到的内容。

  ```js
  // 用户输入
  var str = "123abc456def";
  var reg = /[a-zA-z]/g;
  var result = str.replace(reg, "");
  console.log(result); // 123456
  ```

- `reg.test()`

  用于检测字符串和正则表达式匹配成功。`reg.test()`返回值是布尔值 true/false。

  ```js
  //假设是用户输入的字符串
  var str = "123";
  //正则表达式
  var reg = /123/;
  var result = reg.test(str);
  console.log(result); //true 匹配成功
  ```

  ```js
  var str = "456";
  var reg = /123/;
  var result = reg.test(str);
  console.log(result); //false 失败
  ```

- `reg.exec()`

  显示匹配的内容。`reg.exec()`返回值是匹配的内容。

  ```js
  var str = "s";
  var reg = /[a-z]/;
  var result = reg.exec(str);
  console.log(result); //["s", index: 0, input: "s", groups: undefined]
  ```

## 例 1：验证邮箱格式

`\w` ：数字、字母、下划线； `{5,12}`：5 位到 12 位

```js
// 用户输入
var str = "xiaozhou@163.com";
// 规定邮箱格式
var reg = /^\w{5,12}@163\.com$/;
// reg.test返回的是布尔值 true/false。因此可以用if语句判断是否通过。
if (reg.test(str)) {
  console.log("OK!!!");
} else {
  console.log("SORRY...");
}
```

## 例 2：截取字符串

字符串 “2021-01-01”，可以将其数字部分截取出来。`()` 分组

```js
var str = "2021-2-1";
var reg = /^(\d{4})-(\d{1,2})-(\d{1,2})$/;
var result = reg.exec(str);
console.log(result); // ["2019-12-01", "2019", "12", "01", index: 0, input: "2019-12-01", groups: undefined]
console.log(result[1]); // 2019
console.log(result[2]); // 12
console.log(result[3]); // 01
```

## 例 3：字符串替换

去掉字符串中的字母，把字符串中的某个内容替换成某个内容。

如，“123a456b789c”，去掉字符串中的所有字母（ `str.replace` )。

```js
// 用户输入
var str = "123abc456def";
var reg = /[a-zA-z]/g; //全局匹配 找到所有能匹配到的内容
var result = str.replace(reg, "");
console.log(result); // 123456
```

## 例 4： 替换两端中文双引号
如，“ 我“爱”你””，去掉两端中文双引号。
```js
// var str = '“1”“我”“爱”“你”';
var str = ' 我“爱”你”'
console.log(str)
var str1 = str.replace(/^[“]+/, "");
var str2 = str1.replace(/[”]$/, "");
console.log(str2)//  我“爱”你
//-------------------------------//
var str = ' 我“爱”你”'
console.log(str)
var str1 = str.replace(/[“]+/, "");
var str2 = str1.replace(/[”]$/, "");
console.log(str2) //   我爱”你
```

## 课后练习

### 1. 编写正则表达式，用于验证电话号码。

```js
var phoneNumber = "18503084396";
var reg =
  /^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/;
if (reg.test(phoneNumber)) {
  console.log("OK!!!");
} else {
  console.log("SORRY...");
}
```

### 2. 编写正则表达式，用于验证邮箱格式。

```js
var EmailAddress = "xiaozhou123@126.com";
var reg = /^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;
if (reg.test(EmailAddress)) {
  console.log("OK!!!");
} else {
  console.log("SORRY...");
}
```

## 实际开发中...

大部分情况下，是不需要我们自己写正则表达式的。

邮箱或电话的验证方式：有很多现成的解决方案。

截取和替换数据，掌握一些常用语法即可。

> 以上内容编写于2021年8月18日02点10分。
## 常用正则表达式（转载）

### 一、校验数字的表达式

```
数字：^[0-9]*$
n 位的数字：^\d{n}$
至少 n 位的数字：^\d{n,}$
m-n 位的数字：^\d{m,n}$
零和非零开头的数字：^(0|[1-9][0-9]*)$
非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(\.[0-9]{1,2})?$
带 1-2 位小数的正数或负数：^(\-)?\d+(\.\d{1,2})$
正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$
有两位小数的正实数：^[0-9]+(\.[0-9]{2})?$
有 1~3 位小数的正实数：^[0-9]+(\.[0-9]{1,3})?$
非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*){1,3}$ 或 ^\+?[1-9][0-9]*$
非零的负整数：^\-[1-9][] 0-9"*$ 或 ^-[1-9]\d*$
非负整数：^\d+$ 或 ^[1-9]\d*|0$
非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$
非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$
非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$
正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$
负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$
浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$
```

### 二、校验字符的表达式

```
汉字：^[\u4e00-\u9fa5]{0,}$
英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]{4,40}$
长度为 3-20 的所有字符：^.{3,20}$
由 26 个英文字母组成的字符串：^[A-Za-z]+$
由 26 个大写英文字母组成的字符串：^[A-Z]+$
由 26 个小写英文字母组成的字符串：^[a-z]+$
由数字和 26 个英文字母组成的字符串：^[A-Za-z0-9]+$
由数字、26 个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w {3,20}$
中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$
中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]{2,20}$
可以输入含有 ^%&',;=?$\" 等字符：[^%&',;=?$\x22]+
禁止输入含有～的字符：[^~\x22]+
```

### 三、特殊需求表达式

```
Email 地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$
域名：[a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+\.?
InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&=]*)?$
手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|4|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$
电话号码 ("XXX-XXXXXXX"、"XXXX-XXXXXXXX"、"XXX-XXXXXXX"、"XXX-XXXXXXXX"、"XXXXXXX" 和 "XXXXXXXX)：^(\(\d{3,4}-)|\d{3.4}-)?\d{7,8}$
国内电话号码 (0511-4405222、021-87888822)：\d{3}-\d{8}|\d{4}-\d{7}
电话号码正则表达式（支持手机号码，3-4 位区号，7-8 位直播号码，1－4 位分机号）: ((\d{11})|^((\d{7,8})|(\d{4}|\d{3})-(\d{7,8})|(\d{4}|\d{3})-(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1})|(\d{7,8})-(\d{4}|\d{3}|\d{2}|\d{1}))$)
身份证号 (15 位、18 位数字)，最后一位是校验位，可能为数字或字符 X：(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)
帐号是否合法 (字母开头，允许 5-16 字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]{4,15}$
密码 (以字母开头，长度在 6~18 之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w{5,17}$
强密码 (必须包含大小写字母和数字的组合，不能使用特殊字符，长度在 8-10 之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])[a-zA-Z0-9]{8,10}$
强密码 (必须包含大小写字母和数字的组合，可以使用特殊字符，长度在 8-10 之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,10}$
日期格式：^\d{4}-\d{1,2}-\d{1,2}
一年的 12 个月 (01～09 和 1～12)：^(0?[1-9]|1[0-2])$
一个月的 31 天 (01～09 和 1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$
钱的输入格式：
有四种钱的表示形式我们可以接受:"10000.00" 和 "10,000.00", 和没有 "分" 的 "10000" 和 "10,000"：^[1-9][0-9]*$
这表示任意一个不以 0 开头的数字，但是，这也意味着一个字符 "0" 不通过，所以我们采用下面的形式：^(0|[1-9][0-9]*)$
一个 0 或者一个不以 0 开头的数字。我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$
这表示一个 0 或者一个可能为负的开头不为 0 的数字。让用户以 0 开头好了。把负号的也去掉，因为钱总不能是负的吧。下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$
必须说明的是，小数点后面至少应该有 1 位数，所以 "10." 是不通过的，但是 "10" 和 "10.2" 是通过的：^[0-9]+(.[0-9]{2})?$
这样我们规定小数点后面必须有两位，如果你认为太苛刻了，可以这样：^[0-9]+(.[0-9]{1,2})?$
这样就允许用户只写一位小数。下面我们该考虑数字中的逗号了，我们可以这样：^[0-9]{1,3}(,[0-9]{3})*(.[0-9]{1,2})?$
1 到 3 个数字，后面跟着任意个 逗号 + 3 个数字，逗号成为可选，而不是必须：^([0-9]+|[0-9]{1,3}(,[0-9]{3})*)(.[0-9]{1,2})?$
备注：这就是最终结果了，别忘了 "+" 可以用 "*" 替代如果你觉得空字符串也可以接受的话 (奇怪，为什么？) 最后，别忘了在用函数时去掉去掉那个反斜杠，一般的错误都在这里
xml 文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$
中文字符的正则表达式：[\u4e00-\u9fa5]
双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度 (一个双字节字符长度计 2，ASCII 字符计 1))
空白行的正则表达式：\n\s*\r (可以用来删除空白行)
HTML 标记的正则表达式：<(\S*?)[^>]*>.*?|<.*? /> ( 首尾空白字符的正则表达式：^\s*|\s*$ 或 (^\s*)|(\s*$) (可以用来删除行首行尾的空白字符 (包括空格、制表符、换页符等等)，非常有用的表达式)
腾讯 QQ 号：[1-9][0-9]{4,} (腾讯 QQ 号从 10000 开始)
中国邮政编码：[1-9]\d {5}(?!\d) (中国邮政编码为 6 位数字)
IPv4 地址：((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})(\.((2(5[0-5]|[0-4]\d))|[0-1]?\d{1,2})){3}
```

